<div class = "container" style = "margin-top: 5%">
    <h3>Welcome to PMReferrals.ca<sup style = "color: red">BETA</sup></h3>
    <b>Get a referral code for a new Public Mobile account, OR</b><br>
    <b>add your number to get referral rewards on your existing account.</b>
</div>
<div class = "container" style = "margin-top: 3%">
    <div class = "row">
        <a href = "/referral" class = "u-half-width button confirm">Get a referral number</a>
        <a href = "/join" class = "u-half-width button">Add my number to the list</a><br>
    </div>
    <div class = "row">
        <hr>
        <h5>Already registered? Go to your account.</h5>
        <b>A permalink will be sent to you via email. Make sure <i>noreply@pmreferrals.ca</i> is whitelisted.</b><br><br>
        <input id = "email" size = "28" type = "text" placeholder = "Email address"></input>
        <button id = "send_link" onclick = "verifyEmail()" class = "button">View my account</a>
    </div>
</div>

<!--Footer-->
<div class = "container bottom-space" style = "margin-top: 10%">
    <a href = "https://openode.io" target = "_blank"><img style = "padding-right: 10px" title = "Hosted by Openode" src = "/images/openode.png"></img></a>
    <img title = "Made in Canada" src = "/images/flag.png"></img>
    <br>
    <a target = "_blank" href = "/faq">FAQ</a>
    <a target = "_blank" href = "https://github.com/jsbrn/pmreferrals">Source Code</a>
</div>

<script>
    function verifyEmail() {
        $("#send_link")[0].innerHTML = "Sending...";
        post("/api/request_login", {email: $("#email")[0].value}, function(data, status) {
            console.log(data, status);
            $("#send_link")[0].innerHTML = data;
        });
    }
    

    function post(url, data, callback) {
        $.ajax({
            url: url,
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(data),
            success: callback
        });
    }
</script>